race_metadata:
  year: 2024
  race_number: 0
  circuit_name: "Unknown"
  race_id: 0

camera:
  resolution: "1280x720"
  fps: 30

capture:
  # Capture mode can be 'periodic', 'manual', or 'both'
  mode: "both"
  interval_seconds: 15
  storage_paths:
    input: "data/input"
    processed: "data/processed"
    failed: "data/failed"
    manual: "data/manual"

database:
  type: "sqlite"
  path: "data/f1_data.db"
  processing_interval: 300  # 5 minutes

logging:
  level: "INFO"

llm:
  provider: "together"  # or 'ollama'
  ollama_host: "http://10.0.20.17:11434"
  ollama_model: "granite3.2-vision:latest"
  together_model: "meta-llama/Llama-4-Scout-17B-16E-Instruct"
  prompts:
    full_extraction: |
      You are an expert F1 Telemetry Optical Character Recognition (OCR) system. Your task is to extract race data from the provided image of an F1 timing screen and output it as a valid, parsable JSON object.
      
      ### OBJECTIVE
      Analyze the image and return a SINGLE JSON object containing the current state of the race.
      
      ### INSTRUCTIONS
      
      **1. Identify Global Race Status**
      *   **Safety Car**: Check the top of the timing table or graphic for a "Safety Car" or "VSC" (Virtual Safety Car) notification.
      *   **Red Flag**: Check for a RED FLAG indicator (often red background text or banner).
      *   **Yellow Flag**: Check for a YELLOW FLAG indicator (often yellow background text or banner).
      *   **Lap Number**: Locate the current lap number.
      
      **2. Extract Race Data (Rows)**
      For each driver row visible, extract:
      *   **Position:** The integer rank.
      *   **Driver:** The 3-character driver code.
      *   **Tire:** The tire compound character (S, M, H, I, W).
      *   **Timing Data:** Populate ONLY the fields that are currently visible on the screen. Set others to `null`.
          *   `gap_to_leader`: Time gap to leader (e.g., "Leader", "+2.408").
          *   `interval`: Time gap to driver ahead (e.g., "+0.5s").
          *   `laps_on_tire`: Integer count of laps on current tire.
          *   `pit_stop_count`: Integer count of pit stops.
      *   **Flags:** Look for a red or yellow exclamation point icon next to the timing data.
          *   Yellow exclamation point: **Investigation** (set `investigation` to true)
          *   Red exclamation point: **Penalty** (set `penalty` to true)
      
      ### OUTPUT FORMAT
      Output **only** raw JSON.
      
      **JSON Structure:**
      ```json
      {
        "lap_number": integer,
        "safety_car": boolean,
        "red_flag": boolean,
        "yellow_flag": boolean,
        "race_data": [
          {
            "position": integer,
            "driver": "string",
            "gap_to_leader": "string or null",
            "interval": "string or null",
            "laps_on_tire": integer or null,
            "pit_stop_count": integer or null,
            "tire": "string",
            "investigation": boolean,
            "penalty": boolean
          }
        ]
      }
      ```
      
      ### EXAMPLES
      
      **Example 1: Gap to Leader visible**
      ```json
      {
        "lap_number": 4,
        "safety_car": true,
        "red_flag": false,
        "yellow_flag": true,
        "race_data": [
          {"position": 1, "driver": "RUS", "gap_to_leader": "Leader", "interval": null, "laps_on_tire": null, "pit_stop_count": null, "tire": "M", "investigation": false, "penalty": false},
          {"position": 2, "driver": "VER", "gap_to_leader": "+2.408", "interval": null, "laps_on_tire": null, "pit_stop_count": null, "tire": "S", "investigation": true, "penalty": false}
        ]
      }
      ```
      
      **Example 2: Tire Age visible**
      ```json
      {
        "lap_number": 15,
        "safety_car": false,
        "red_flag": false,
        "yellow_flag": false,
        "race_data": [
          {"position": 1, "driver": "RUS", "gap_to_leader": null, "interval": null, "laps_on_tire": 14, "pit_stop_count": null, "tire": "M", "investigation": false, "penalty": false},
          {"position": 2, "driver": "VER", "gap_to_leader": null, "interval": null, "laps_on_tire": 17, "pit_stop_count": null, "tire": "S", "investigation": false, "penalty": false}
        ]
      }
      ```
      
      **Example 3: Interval visible**
      ```json
      {
        "lap_number": 4,
        "safety_car": false,
        "red_flag": false,
        "yellow_flag": false,
        "race_data": [
          {"position": 1, "driver": "RUS", "gap_to_leader": null, "interval": "Leader", "laps_on_tire": null, "pit_stop_count": null, "tire": "M", "investigation": false, "penalty": false},
          {"position": 2, "driver": "VER", "gap_to_leader": null, "interval": "+2.379", "laps_on_tire": null, "pit_stop_count": null, "tire": "S", "investigation": false, "penalty": false},
          {"position": 3, "driver": "NOR", "gap_to_leader": null, "interval": "+1.187", "laps_on_tire": null, "pit_stop_count": null, "tire": "M", "investigation": false, "penalty": true}
        ]
      }
      ```