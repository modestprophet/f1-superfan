race_metadata:
  year: 2024
  race_number: 0
  circuit_name: "Unknown"
  race_id: 0

camera:
  resolution: "1280x720"
  fps: 30

capture:
  # Capture mode can be 'periodic', 'manual', or 'both'
  mode: "both"
  interval_seconds: 15
  storage_paths:
    input: "data/input"
    processed: "data/processed"
    failed: "data/failed"
    manual: "data/manual"

database:
  type: "sqlite"
  path: "data/f1_data.db"
  processing_interval: 300  # 5 minutes

logging:
  level: "INFO"

llm:
  provider: "together"  # or 'ollama'
  ollama_host: "http://10.0.20.17:11434"
  ollama_model: "granite3.2-vision:latest"
  together_model: "meta-llama/Llama-4-Scout-17B-16E-Instruct"
  prompts:
    full_extraction: |
      You are an expert F1 Telemetry Optical Character Recognition (OCR) system. Your task is to extract race data from the provided image of an F1 timing screen and output it as a valid, parsable JSON object.
      
      ### OBJECTIVE
      Analyze the image and return a SINGLE JSON object containing the current state of the race.
      
      ### INSTRUCTIONS
      
      **1. Identify Global Race Status**
      *   **Safety Car**: Check the top of the timing table or graphic for a "Safety Car" or "VSC" (Virtual Safety Car) notification.
      *   **Lap Number**: Locate the current lap number.
      
      **2. Determine the Table Type**
      Analyze the data columns and headers to categorize the table into exactly one of the following types:
      *   **`interval`**: Represents the time gap to the *driver directly ahead*.
          *   *Visual Cue:* Column header "Interval".
          *   *Data Pattern:* Times are random and varied (e.g., +0.5s, +1.2s, +0.3s).
      *   **`gap`**: Represents the time gap to the *race leader*.
          *   *Visual Cue:* Column header "Gap" or "Leader".
          *   *Data Pattern:* Times increase sequentially as position rank drops.
      *   **`tire_age`**: Represents the laps driven on the current tire.
          *   *Visual Cue:* Header "Tire" or "Laps".
          *   *Data Pattern:* Data consists of integers.
      *   **`pitstops`**: Represents the count of pitstops.
          *   *Visual Cue:* Header "Stops" or "Pit".
          *   *Data Pattern:* Small integers (e.g., 0, 1, 2).
      
      **3. Extract Race Data (Rows)**
      For each driver row visible, extract:
      *   **Position:** The integer rank.
      *   **Driver:** The 3-character driver code.
      *   **Data:** The main value in the timing/data column.
      *   **Tire:** The tire compound character (S, M, H, I, W).
      *   **Flags:** Look for a red or yellow exclamation point icon next to the timing data.
          *   Yellow exclamation point: **Investigation**
          *   Red exclamation point: **Penalty**
      
      ### OUTPUT FORMAT
      Output **only** raw JSON.
      
      **JSON Structure:**
      ```json
      {
        "lap_number": integer,
        "safety_car": boolean,
        "table_type": "string",
        "race_data": [
          {
            "position": integer,
            "driver": "string",
            "data": "string or number",
            "tire": "string",
            "investigation": boolean,
            "penalty": boolean
          }
        ]
      }
      ```
      
      ### EXAMPLES
      
      **Example 1: Gap to Leader**
      ```json
      {
        "lap_number": 4,
        "safety_car": true,
        "table_type": "gap",
        "race_data": [
          {"position": 1, "driver": "RUS", "data": "Leader", "tire": "M", "investigation": false, "penalty": false},
          {"position": 2, "driver": "VER", "data": "+2.408", "tire": "S", "investigation": true, "penalty": false}
        ]
      }
      ```
      
      **Example 2: Tire Age**
      ```json
      {
        "lap_number": 15,
        "safety_car": false,
        "table_type": "tire_age",
        "race_data": [
          {"position": 1, "driver": "RUS", "data": "14", "tire": "M", "investigation": false, "penalty": false},
          {"position": 2, "driver": "VER", "data": "17", "tire": "S", "investigation": false, "penalty": false}
        ]
      }
      ```
      
      **Example 3: Pitstop Count**
      ```json
      {
        "lap_number": 23,
        "safety_car": false,
        "table_type": "pitstops",
        "race_data": [
          {"position": 1, "driver": "RUS", "data": 0, "tire": "H", "investigation": false, "penalty": false},
          {"position": 2, "driver": "NOR", "data": 1, "tire": "M", "investigation": false, "penalty": false}
        ]
      }
      ```
      
      **Example 4: Interval**
      ```json
      {
        "lap_number": 4,
        "safety_car": false,
        "table_type": "interval",
        "race_data": [
          {"position": 1, "driver": "RUS", "data": "Leader", "tire": "M", "investigation": false, "penalty": false},
          {"position": 2, "driver": "VER", "data": "+2.379", "tire": "S", "investigation": false, "penalty": false},
          {"position": 3, "driver": "NOR", "data": "+1.187", "tire": "M", "investigation": false, "penalty": true}
        ]
      }
      ```